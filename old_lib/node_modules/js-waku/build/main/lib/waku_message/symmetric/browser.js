"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateIv = exports.decrypt = exports.encrypt = void 0;
const index_1 = require("./index");
const crypto = window.crypto || window.msCrypto;
const subtle = crypto.subtle || crypto.webkitSubtle;
const Algorithm = { name: 'AES-GCM', length: 128 };
if (subtle === undefined) {
    throw new Error('Failed to load Subtle CryptoAPI');
}
async function encrypt(iv, key, clearText) {
    return subtle
        .importKey('raw', key, Algorithm, false, ['encrypt'])
        .then((cryptoKey) => subtle.encrypt(Object.assign({ iv }, Algorithm), cryptoKey, clearText))
        .then(Buffer.from);
}
exports.encrypt = encrypt;
async function decrypt(iv, key, cipherText) {
    return subtle
        .importKey('raw', key, Algorithm, false, ['decrypt'])
        .then((cryptoKey) => subtle.decrypt(Object.assign({ iv }, Algorithm), cryptoKey, cipherText))
        .then(Buffer.from);
}
exports.decrypt = decrypt;
function generateIv() {
    const iv = new Uint8Array(index_1.IvSize);
    crypto.getRandomValues(iv);
    return iv;
}
exports.generateIv = generateIv;
//# sourceMappingURL=browser.js.map