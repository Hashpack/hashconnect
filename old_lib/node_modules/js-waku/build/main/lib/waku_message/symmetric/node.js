"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateIv = exports.decrypt = exports.encrypt = void 0;
const crypto_1 = require("crypto");
const index_1 = require("./index");
const Algorithm = 'aes-256-gcm';
async function encrypt(iv, key, clearText) {
    const cipher = crypto_1.createCipheriv(Algorithm, key, iv);
    const a = cipher.update(clearText);
    const b = cipher.final();
    const tag = cipher.getAuthTag();
    return Buffer.concat([a, b, tag]);
}
exports.encrypt = encrypt;
async function decrypt(iv, key, data) {
    const tagStart = data.length - index_1.TagSize;
    const cipherText = data.slice(0, tagStart);
    const tag = data.slice(tagStart);
    const decipher = crypto_1.createDecipheriv(Algorithm, key, iv);
    decipher.setAuthTag(tag);
    const a = decipher.update(cipherText);
    const b = decipher.final();
    return Buffer.concat([a, b]);
}
exports.decrypt = decrypt;
function generateIv() {
    return crypto_1.randomBytes(index_1.IvSize);
}
exports.generateIv = generateIv;
//# sourceMappingURL=node.js.map