(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2pMplex = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Libp2pMplex=(()=>{var E=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Pe=E((Mn,k)=>{var Ne=(...r)=>{let e;for(;r.length;)e=r.shift()(e);return e},ue=r=>r&&(typeof r[Symbol.asyncIterator]=="function"||typeof r[Symbol.iterator]=="function"||typeof r.next=="function"),Z=r=>r&&typeof r.sink=="function"&&ue(r.source),or=r=>e=>(r.sink(e),r.source),ke=(...r)=>{if(Z(r[0])){let e=r[0];r[0]=()=>e.source}else if(ue(r[0])){let e=r[0];r[0]=()=>e}if(r.length>1&&Z(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let e=1;e<r.length-1;e++)Z(r[e])&&(r[e]=or(r[e]));return Ne(...r)};k.exports=ke;k.exports.pipe=ke;k.exports.rawPipe=Ne;k.exports.isIterable=ue;k.exports.isDuplex=Z});var qe=E((On,De)=>{De.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var ze=E((kn,$e)=>{var Ge=qe();$e.exports=class{constructor(e){this.hwm=e||16,this.head=new Ge(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let t=this.head;this.head=t.next=new Ge(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var ce=E((Pn,je)=>{var fe=ze();je.exports=r=>{r=r||{};let e;typeof r=="function"?(e=r,r={}):e=r.onEnd;let t=new fe,n,i,o,s=()=>{if(!t.isEmpty()){if(r.writev){let w,d=[];for(;!t.isEmpty();){if(w=t.shift(),w.error)throw w.error;d.push(w.value)}return{done:w.done,value:d}}let y=t.shift();if(y.error)throw y.error;return y}return o?{done:!0}:new Promise((y,w)=>{i=d=>(i=null,d.error?w(d.error):r.writev&&!d.done?y({done:d.done,value:[d.value]}):y(d),n)})},a=y=>i?i(y):(t.push(y),n),h=y=>(t=new fe,i?i({error:y}):(t.push({error:y}),n)),l=y=>o?n:a({done:!1,value:y}),f=y=>o?n:(o=!0,y?h(y):a({done:!0})),c=()=>(t=new fe,f(),{done:!0}),p=y=>(f(y),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:s,return:c,throw:p,push:l,end:f},!e)return n;let x=n;return n={[Symbol.asyncIterator](){return this},next(){return x.next()},throw(y){return x.throw(y),e&&(e(y),e=null),{done:!0}},return(){return x.return(),e&&(e(),e=null),{done:!0}},push:l,end(y){return x.end(y),e&&(e(y),e=null),n}},n}});var Ve=E((Dn,We)=>{var P=1e3,D=P*60,q=D*60,M=q*24,sr=M*7,ur=M*365.25;We.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return fr(r);if(t==="number"&&isFinite(r))return e.long?hr(r):cr(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function fr(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*ur;case"weeks":case"week":case"w":return t*sr;case"days":case"day":case"d":return t*M;case"hours":case"hour":case"hrs":case"hr":case"h":return t*q;case"minutes":case"minute":case"mins":case"min":case"m":return t*D;case"seconds":case"second":case"secs":case"sec":case"s":return t*P;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function cr(r){var e=Math.abs(r);return e>=M?Math.round(r/M)+"d":e>=q?Math.round(r/q)+"h":e>=D?Math.round(r/D)+"m":e>=P?Math.round(r/P)+"s":r+"ms"}function hr(r){var e=Math.abs(r);return e>=M?J(r,e,M,"day"):e>=q?J(r,e,q,"hour"):e>=D?J(r,e,D,"minute"):e>=P?J(r,e,P,"second"):r+" ms"}function J(r,e,t,n){var i=e>=t*1.5;return Math.round(r/t)+" "+n+(i?"s":"")}});var ve=E((qn,Xe)=>{function ar(r){t.debug=t,t.default=t,t.coerce=h,t.disable=o,t.enable=i,t.enabled=s,t.humanize=Ve(),t.destroy=l,Object.keys(r).forEach(f=>{t[f]=r[f]}),t.names=[],t.skips=[],t.formatters={};function e(f){let c=0;for(let p=0;p<f.length;p++)c=(c<<5)-c+f.charCodeAt(p),c|=0;return t.colors[Math.abs(c)%t.colors.length]}t.selectColor=e;function t(f){let c,p=null,x,y;function w(...d){if(!w.enabled)return;let m=w,H=Number(new Date),rr=H-(c||H);m.diff=rr,m.prev=c,m.curr=H,c=H,d[0]=t.coerce(d[0]),typeof d[0]!="string"&&d.unshift("%O");let Y=0;d[0]=d[0].replace(/%([a-zA-Z%])/g,(se,nr)=>{if(se==="%%")return"%";Y++;let Oe=t.formatters[nr];if(typeof Oe=="function"){let ir=d[Y];se=Oe.call(m,ir),d.splice(Y,1),Y--}return se}),t.formatArgs.call(m,d),(m.log||t.log).apply(m,d)}return w.namespace=f,w.useColors=t.useColors(),w.color=t.selectColor(f),w.extend=n,w.destroy=t.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(x!==t.namespaces&&(x=t.namespaces,y=t.enabled(f)),y),set:d=>{p=d}}),typeof t.init=="function"&&t.init(w),w}function n(f,c){let p=t(this.namespace+(typeof c=="undefined"?":":c)+f);return p.log=this.log,p}function i(f){t.save(f),t.namespaces=f,t.names=[],t.skips=[];let c,p=(typeof f=="string"?f:"").split(/[\s,]+/),x=p.length;for(c=0;c<x;c++)!p[c]||(f=p[c].replace(/\*/g,".*?"),f[0]==="-"?t.skips.push(new RegExp("^"+f.substr(1)+"$")):t.names.push(new RegExp("^"+f+"$")))}function o(){let f=[...t.names.map(a),...t.skips.map(a).map(c=>"-"+c)].join(",");return t.enable(""),f}function s(f){if(f[f.length-1]==="*")return!0;let c,p;for(c=0,p=t.skips.length;c<p;c++)if(t.skips[c].test(f))return!1;for(c=0,p=t.names.length;c<p;c++)if(t.names[c].test(f))return!0;return!1}function a(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function h(f){return f instanceof Error?f.stack||f.message:f}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}Xe.exports=ar});var he=E((I,K)=>{I.formatArgs=lr;I.save=pr;I.load=dr;I.useColors=yr;I.storage=wr();I.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();I.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function yr(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function lr(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+K.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(n=t))}),r.splice(n,0,e)}I.log=console.debug||console.log||(()=>{});function pr(r){try{r?I.storage.setItem("debug",r):I.storage.removeItem("debug")}catch(e){}}function dr(){let r;try{r=I.storage.getItem("debug")}catch(e){}return!r&&typeof process!="undefined"&&"env"in process&&(r=process.env.DEBUG),r}function wr(){try{return localStorage}catch(r){}}K.exports=ve()(I);var{formatters:Er}=K.exports;Er.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Ye=E(($n,He)=>{He.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var Je=E((zn,Ze)=>{Ze.exports=class extends Error{constructor(e,t){super(e||"The operation was aborted");this.type="aborted",this.code=t||"ABORT_ERR"}}});var pe=E((jn,L)=>{var gr=Ye(),ae=Je(),Ke=(r,e,t)=>le(r,Array.isArray(e)?e:[{signal:e,options:t}]),le=(r,e)=>{r=gr(r),e=e.map(({signal:n,options:i})=>({signal:n,options:i||{}}));async function*t(){let n,i=()=>{n&&n()};for(let{signal:o}of e)o.addEventListener("abort",i);for(;;){let o;try{for(let{signal:a,options:h}of e)if(a.aborted){let{abortMessage:l,abortCode:f}=h;throw new ae(l,f)}let s=new Promise((a,h)=>{n=()=>{let{options:l}=e.find(({signal:p})=>p.aborted),{abortMessage:f,abortCode:c}=l;h(new ae(f,c))}});o=await Promise.race([s,r.next()]),n=null}catch(s){for(let{signal:l}of e)l.removeEventListener("abort",i);let a=e.find(({signal:l})=>l.aborted),h=s.type==="aborted"&&a;if(h&&a.options.onAbort&&await a.options.onAbort(r),typeof r.return=="function"&&await r.return(),h&&a.options.returnOnAbort)return;throw s}if(o.done)break;yield o.value}for(let{signal:o}of e)o.removeEventListener("abort",i)}return t()},et=(r,e,t)=>Qe(r,Array.isArray(e)?e:[{signal:e,options:t}]),Qe=(r,e)=>t=>r(le(t,e)),mr=(r,e,t)=>xr(r,Array.isArray(e)?e:[{signal:e,options:t}]),xr=(r,e)=>({sink:Qe(r.sink,e),source:le(r.source,e)});L.exports=Ke;L.exports.AbortError=ae;L.exports.source=Ke;L.exports.sink=et;L.exports.transform=et;L.exports.duplex=mr});var nt=E((Wn,tt)=>{tt.exports=de;var rt=128,br=127,Br=~br,Ir=Math.pow(2,31);function de(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw de.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var n=t;r>=Ir;)e[t++]=r&255|rt,r/=128;for(;r&Br;)e[t++]=r&255|rt,r>>>=7;return e[t]=r|0,de.bytes=t-n+1,e}});var st=E((Vn,it)=>{it.exports=ye;var Fr=128,ot=127;function ye(r,e){var t=0,e=e||0,n=0,i=e,o,s=r.length;do{if(i>=s||n>49)throw ye.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=n<28?(o&ot)<<n:(o&ot)*Math.pow(2,n),n+=7}while(o>=Fr);return ye.bytes=i-e,t}});var ft=E((Xn,ut)=>{var Cr=Math.pow(2,7),_r=Math.pow(2,14),Ar=Math.pow(2,21),Sr=Math.pow(2,28),Rr=Math.pow(2,35),Tr=Math.pow(2,42),Ur=Math.pow(2,49),Mr=Math.pow(2,56),Lr=Math.pow(2,63);ut.exports=function(r){return r<Cr?1:r<_r?2:r<Ar?3:r<Sr?4:r<Rr?5:r<Tr?6:r<Ur?7:r<Mr?8:r<Lr?9:10}});var we=E((vn,ct)=>{ct.exports={encode:nt(),decode:st(),encodingLength:ft()}});var at=E(Q=>{"use strict";Q.byteLength=Or;Q.toByteArray=Nr;Q.fromByteArray=kr;var _=[],F=[],Pr=typeof Uint8Array!="undefined"?Uint8Array:Array,Ee="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var $=0,Dr=Ee.length;$<Dr;++$)_[$]=Ee[$],F[Ee.charCodeAt($)]=$;F["-".charCodeAt(0)]=62;F["_".charCodeAt(0)]=63;function ht(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function Or(r){var e=ht(r),t=e[0],n=e[1];return(t+n)*3/4-n}function qr(r,e,t){return(e+t)*3/4-t}function Nr(r){var e,t=ht(r),n=t[0],i=t[1],o=new Pr(qr(r,n,i)),s=0,a=i>0?n-4:n,h;for(h=0;h<a;h+=4)e=F[r.charCodeAt(h)]<<18|F[r.charCodeAt(h+1)]<<12|F[r.charCodeAt(h+2)]<<6|F[r.charCodeAt(h+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=F[r.charCodeAt(h)]<<2|F[r.charCodeAt(h+1)]>>4,o[s++]=e&255),i===1&&(e=F[r.charCodeAt(h)]<<10|F[r.charCodeAt(h+1)]<<4|F[r.charCodeAt(h+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function $r(r){return _[r>>18&63]+_[r>>12&63]+_[r>>6&63]+_[r&63]}function Gr(r,e,t){for(var n,i=[],o=e;o<t;o+=3)n=(r[o]<<16&16711680)+(r[o+1]<<8&65280)+(r[o+2]&255),i.push($r(n));return i.join("")}function kr(r){for(var e,t=r.length,n=t%3,i=[],o=16383,s=0,a=t-n;s<a;s+=o)i.push(Gr(r,s,s+o>a?a:s+o));return n===1?(e=r[t-1],i.push(_[e>>2]+_[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(_[e>>10]+_[e>>4&63]+_[e<<2&63]+"=")),i.join("")}});var lt=E(ge=>{ge.read=function(r,e,t,n,i){var o,s,a=i*8-n-1,h=(1<<a)-1,l=h>>1,f=-7,c=t?i-1:0,p=t?-1:1,x=r[e+c];for(c+=p,o=x&(1<<-f)-1,x>>=-f,f+=a;f>0;o=o*256+r[e+c],c+=p,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=n;f>0;s=s*256+r[e+c],c+=p,f-=8);if(o===0)o=1-l;else{if(o===h)return s?NaN:(x?-1:1)*Infinity;s=s+Math.pow(2,n),o=o-l}return(x?-1:1)*s*Math.pow(2,o-n)};ge.write=function(r,e,t,n,i,o){var s,a,h,l=o*8-i-1,f=(1<<l)-1,c=f>>1,p=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,x=n?0:o-1,y=n?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===Infinity?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-s))<1&&(s--,h*=2),s+c>=1?e+=p/h:e+=p*Math.pow(2,1-c),e*h>=2&&(s++,h/=2),s+c>=f?(a=0,s=f):s+c>=1?(a=(e*h-1)*Math.pow(2,i),s=s+c):(a=e*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;r[t+x]=a&255,x+=y,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;r[t+x]=s&255,x+=y,s/=256,l-=8);r[t+x-y]|=w*128}});var Rt=E(G=>{"use strict";var xe=at(),z=lt(),pt=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;G.Buffer=u;G.SlowBuffer=zr;G.INSPECT_MAX_BYTES=50;var ee=2147483647;G.kMaxLength=ee;u.TYPED_ARRAY_SUPPORT=jr();!u.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function jr(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch(r){return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(!!u.isBuffer(this))return this.buffer}});Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(!!u.isBuffer(this))return this.byteOffset}});function S(r){if(r>ee)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,u.prototype),e}function u(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return me(r)}return dt(r,e,t)}u.poolSize=8192;function dt(r,e,t){if(typeof r=="string")return Wr(r,e);if(ArrayBuffer.isView(r))return Vr(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(A(r,ArrayBuffer)||r&&A(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(A(r,SharedArrayBuffer)||r&&A(r.buffer,SharedArrayBuffer)))return be(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=r.valueOf&&r.valueOf();if(n!=null&&n!==r)return u.from(n,e,t);let i=Xr(r);if(i)return i;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return u.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}u.from=function(r,e,t){return dt(r,e,t)};Object.setPrototypeOf(u.prototype,Uint8Array.prototype);Object.setPrototypeOf(u,Uint8Array);function yt(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function vr(r,e,t){return yt(r),r<=0?S(r):e!==void 0?typeof t=="string"?S(r).fill(e,t):S(r).fill(e):S(r)}u.alloc=function(r,e,t){return vr(r,e,t)};function me(r){return yt(r),S(r<0?0:Be(r)|0)}u.allocUnsafe=function(r){return me(r)};u.allocUnsafeSlow=function(r){return me(r)};function Wr(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!u.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=wt(r,e)|0,n=S(t),i=n.write(r,e);return i!==t&&(n=n.slice(0,i)),n}function Ie(r){let e=r.length<0?0:Be(r.length)|0,t=S(e);for(let n=0;n<e;n+=1)t[n]=r[n]&255;return t}function Vr(r){if(A(r,Uint8Array)){let e=new Uint8Array(r);return be(e.buffer,e.byteOffset,e.byteLength)}return Ie(r)}function be(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&t===void 0?n=new Uint8Array(r):t===void 0?n=new Uint8Array(r,e):n=new Uint8Array(r,e,t),Object.setPrototypeOf(n,u.prototype),n}function Xr(r){if(u.isBuffer(r)){let e=Be(r.length)|0,t=S(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||Fe(r.length)?S(0):Ie(r);if(r.type==="Buffer"&&Array.isArray(r.data))return Ie(r.data)}function Be(r){if(r>=ee)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ee.toString(16)+" bytes");return r|0}function zr(r){return+r!=r&&(r=0),u.alloc(+r)}u.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==u.prototype};u.compare=function(e,t){if(A(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),A(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,i=t.length;for(let o=0,s=Math.min(n,i);o<s;++o)if(e[o]!==t[o]){n=e[o],i=t[o];break}return n<i?-1:i<n?1:0};u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return u.alloc(0);let n;if(t===void 0)for(t=0,n=0;n<e.length;++n)t+=e[n].length;let i=u.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){let s=e[n];if(A(s,Uint8Array))o+s.length>i.length?(u.isBuffer(s)||(s=u.from(s)),s.copy(i,o)):Uint8Array.prototype.set.call(i,s,o);else if(u.isBuffer(s))s.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return i};function wt(r,e){if(u.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||A(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&t===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Ce(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Et(r).length;default:if(i)return n?-1:Ce(r).length;e=(""+e).toLowerCase(),i=!0}}u.byteLength=wt;function Qr(r,e,t){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return Jr(this,e,t);case"utf8":case"utf-8":return gt(this,e,t);case"ascii":return Yr(this,e,t);case"latin1":case"binary":return Zr(this,e,t);case"base64":return Hr(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Kr(this,e,t);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}u.prototype._isBuffer=!0;function O(r,e,t){let n=r[e];r[e]=r[t],r[t]=n}u.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)O(this,t,t+1);return this};u.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)O(this,t,t+3),O(this,t+1,t+2);return this};u.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)O(this,t,t+7),O(this,t+1,t+6),O(this,t+2,t+5),O(this,t+3,t+4);return this};u.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?gt(this,0,e):Qr.apply(this,arguments)};u.prototype.toLocaleString=u.prototype.toString;u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:u.compare(this,e)===0};u.prototype.inspect=function(){let e="",t=G.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};pt&&(u.prototype[pt]=u.prototype.inspect);u.prototype.compare=function(e,t,n,i,o){if(A(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),t<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&t>=n)return 0;if(i>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;let s=o-i,a=n-t,h=Math.min(s,a),l=this.slice(i,o),f=e.slice(t,n);for(let c=0;c<h;++c)if(l[c]!==f[c]){s=l[c],a=f[c];break}return s<a?-1:a<s?1:0};function mt(r,e,t,n,i){if(r.length===0)return-1;if(typeof t=="string"?(n=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,Fe(t)&&(t=i?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(i)return-1;t=r.length-1}else if(t<0)if(i)t=0;else return-1;if(typeof e=="string"&&(e=u.from(e,n)),u.isBuffer(e))return e.length===0?-1:xt(r,e,t,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):xt(r,[e],t,n,i);throw new TypeError("val must be string, number or Buffer")}function xt(r,e,t,n,i){let o=1,s=r.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||e.length<2)return-1;o=2,s/=2,a/=2,t/=2}function h(f,c){return o===1?f[c]:f.readUInt16BE(c*o)}let l;if(i){let f=-1;for(l=t;l<s;l++)if(h(r,l)===h(e,f===-1?0:l-f)){if(f===-1&&(f=l),l-f+1===a)return f*o}else f!==-1&&(l-=l-f),f=-1}else for(t+a>s&&(t=s-a),l=t;l>=0;l--){let f=!0;for(let c=0;c<a;c++)if(h(r,l+c)!==h(e,c)){f=!1;break}if(f)return l}return-1}u.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1};u.prototype.indexOf=function(e,t,n){return mt(this,e,t,n,!0)};u.prototype.lastIndexOf=function(e,t,n){return mt(this,e,t,n,!1)};function en(r,e,t,n){t=Number(t)||0;let i=r.length-t;n?(n=Number(n),n>i&&(n=i)):n=i;let o=e.length;n>o/2&&(n=o/2);let s;for(s=0;s<n;++s){let a=parseInt(e.substr(s*2,2),16);if(Fe(a))return s;r[t+s]=a}return s}function tn(r,e,t,n){return te(Ce(e,r.length-t),r,t,n)}function nn(r,e,t,n){return te(rn(e),r,t,n)}function on(r,e,t,n){return te(Et(e),r,t,n)}function un(r,e,t,n){return te(sn(e,r.length-t),r,t,n)}u.prototype.write=function(e,t,n,i){if(t===void 0)i="utf8",n=this.length,t=0;else if(n===void 0&&typeof t=="string")i=t,n=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-t;if((n===void 0||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return en(this,e,t,n);case"utf8":case"utf-8":return tn(this,e,t,n);case"ascii":case"latin1":case"binary":return nn(this,e,t,n);case"base64":return on(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return un(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Hr(r,e,t){return e===0&&t===r.length?xe.fromByteArray(r):xe.fromByteArray(r.slice(e,t))}function gt(r,e,t){t=Math.min(r.length,t);let n=[],i=e;for(;i<t;){let o=r[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=t){let h,l,f,c;switch(a){case 1:o<128&&(s=o);break;case 2:h=r[i+1],(h&192)==128&&(c=(o&31)<<6|h&63,c>127&&(s=c));break;case 3:h=r[i+1],l=r[i+2],(h&192)==128&&(l&192)==128&&(c=(o&15)<<12|(h&63)<<6|l&63,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:h=r[i+1],l=r[i+2],f=r[i+3],(h&192)==128&&(l&192)==128&&(f&192)==128&&(c=(o&15)<<18|(h&63)<<12|(l&63)<<6|f&63,c>65535&&c<1114112&&(s=c))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=a}return fn(n)}var bt=4096;function fn(r){let e=r.length;if(e<=bt)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=bt));return t}function Yr(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]&127);return n}function Zr(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]);return n}function Jr(r,e,t){let n=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>n)&&(t=n);let i="";for(let o=e;o<t;++o)i+=cn[r[o]];return i}function Kr(r,e,t){let n=r.slice(e,t),i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}u.prototype.slice=function(e,t){let n=this.length;e=~~e,t=t===void 0?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);let i=this.subarray(e,t);return Object.setPrototypeOf(i,u.prototype),i};function b(r,e,t){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,n){e=e>>>0,t=t>>>0,n||b(e,t,this.length);let i=this[e],o=1,s=0;for(;++s<t&&(o*=256);)i+=this[e+s]*o;return i};u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,n){e=e>>>0,t=t>>>0,n||b(e,t,this.length);let i=this[e+--t],o=1;for(;t>0&&(o*=256);)i+=this[e+--t]*o;return i};u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e=e>>>0,t||b(e,1,this.length),this[e]};u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||b(e,2,this.length),this[e]|this[e+1]<<8};u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||b(e,2,this.length),this[e]<<8|this[e+1]};u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||b(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||b(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};u.prototype.readBigUInt64LE=U(function(e){e=e>>>0,j(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&V(e,this.length-8);let i=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,o=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(o)<<BigInt(32))});u.prototype.readBigUInt64BE=U(function(e){e=e>>>0,j(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&V(e,this.length-8);let i=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],o=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(o)});u.prototype.readIntLE=function(e,t,n){e=e>>>0,t=t>>>0,n||b(e,t,this.length);let i=this[e],o=1,s=0;for(;++s<t&&(o*=256);)i+=this[e+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i};u.prototype.readIntBE=function(e,t,n){e=e>>>0,t=t>>>0,n||b(e,t,this.length);let i=t,o=1,s=this[e+--i];for(;i>0&&(o*=256);)s+=this[e+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*t)),s};u.prototype.readInt8=function(e,t){return e=e>>>0,t||b(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};u.prototype.readInt16LE=function(e,t){e=e>>>0,t||b(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};u.prototype.readInt16BE=function(e,t){e=e>>>0,t||b(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};u.prototype.readInt32LE=function(e,t){return e=e>>>0,t||b(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};u.prototype.readInt32BE=function(e,t){return e=e>>>0,t||b(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};u.prototype.readBigInt64LE=U(function(e){e=e>>>0,j(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&V(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});u.prototype.readBigInt64BE=U(function(e){e=e>>>0,j(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&V(e,this.length-8);let i=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});u.prototype.readFloatLE=function(e,t){return e=e>>>0,t||b(e,4,this.length),z.read(this,e,!0,23,4)};u.prototype.readFloatBE=function(e,t){return e=e>>>0,t||b(e,4,this.length),z.read(this,e,!1,23,4)};u.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||b(e,8,this.length),z.read(this,e,!0,52,8)};u.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||b(e,8,this.length),z.read(this,e,!1,52,8)};function B(r,e,t,n,i,o){if(!u.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(t+n>r.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;B(this,e,t,n,a,0)}let o=1,s=0;for(this[t]=e&255;++s<n&&(o*=256);)this[t+s]=e/o&255;return t+n};u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;B(this,e,t,n,a,0)}let o=n-1,s=1;for(this[t+o]=e&255;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+n};u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,n){return e=+e,t=t>>>0,n||B(this,e,t,1,255,0),this[t]=e&255,t+1};u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t=t>>>0,n||B(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t=t>>>0,n||B(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t=t>>>0,n||B(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t=t>>>0,n||B(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function It(r,e,t,n,i){Bt(e,n,i,r,t,7);let o=Number(e&BigInt(4294967295));r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,t}function Ft(r,e,t,n,i){Bt(e,n,i,r,t,7);let o=Number(e&BigInt(4294967295));r[t+7]=o,o=o>>8,r[t+6]=o,o=o>>8,r[t+5]=o,o=o>>8,r[t+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=s,s=s>>8,r[t+2]=s,s=s>>8,r[t+1]=s,s=s>>8,r[t]=s,t+8}u.prototype.writeBigUInt64LE=U(function(e,t=0){return It(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});u.prototype.writeBigUInt64BE=U(function(e,t=0){return Ft(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});u.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t=t>>>0,!i){let h=Math.pow(2,8*n-1);B(this,e,t,n,h-1,-h)}let o=0,s=1,a=0;for(this[t]=e&255;++o<n&&(s*=256);)e<0&&a===0&&this[t+o-1]!==0&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n};u.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t=t>>>0,!i){let h=Math.pow(2,8*n-1);B(this,e,t,n,h-1,-h)}let o=n-1,s=1,a=0;for(this[t+o]=e&255;--o>=0&&(s*=256);)e<0&&a===0&&this[t+o+1]!==0&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n};u.prototype.writeInt8=function(e,t,n){return e=+e,t=t>>>0,n||B(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};u.prototype.writeInt16LE=function(e,t,n){return e=+e,t=t>>>0,n||B(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};u.prototype.writeInt16BE=function(e,t,n){return e=+e,t=t>>>0,n||B(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};u.prototype.writeInt32LE=function(e,t,n){return e=+e,t=t>>>0,n||B(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};u.prototype.writeInt32BE=function(e,t,n){return e=+e,t=t>>>0,n||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};u.prototype.writeBigInt64LE=U(function(e,t=0){return It(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});u.prototype.writeBigInt64BE=U(function(e,t=0){return Ft(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ct(r,e,t,n,i,o){if(t+n>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function _t(r,e,t,n,i){return e=+e,t=t>>>0,i||Ct(r,e,t,4,34028234663852886e22,-34028234663852886e22),z.write(r,e,t,n,23,4),t+4}u.prototype.writeFloatLE=function(e,t,n){return _t(this,e,t,!0,n)};u.prototype.writeFloatBE=function(e,t,n){return _t(this,e,t,!1,n)};function At(r,e,t,n,i){return e=+e,t=t>>>0,i||Ct(r,e,t,8,17976931348623157e292,-17976931348623157e292),z.write(r,e,t,n,52,8),t+8}u.prototype.writeDoubleLE=function(e,t,n){return At(this,e,t,!0,n)};u.prototype.writeDoubleBE=function(e,t,n){return At(this,e,t,!1,n)};u.prototype.copy=function(e,t,n,i){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);let o=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),t),o};u.prototype.fill=function(e,t,n,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!u.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let s=e.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t=t>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let o;if(typeof e=="number")for(o=t;o<n;++o)this[o]=e;else{let s=u.isBuffer(e)?e:u.from(e,i),a=s.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var W={};function _e(r,e,t){W[r]=class extends t{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}_e("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);_e("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);_e("ERR_OUT_OF_RANGE",function(r,e,t){let n=`The value of "${r}" is out of range.`,i=t;return Number.isInteger(t)&&Math.abs(t)>2**32?i=St(String(t)):typeof t=="bigint"&&(i=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(i=St(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function St(r){let e="",t=r.length,n=r[0]==="-"?1:0;for(;t>=n+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function hn(r,e,t){j(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&V(e,r.length-(t+1))}function Bt(r,e,t,n,i,o){if(r>t||r<e){let s=typeof e=="bigint"?"n":"",a;throw o>3?e===0||e===BigInt(0)?a=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:a=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:a=`>= ${e}${s} and <= ${t}${s}`,new W.ERR_OUT_OF_RANGE("value",a,r)}hn(n,i,o)}function j(r,e){if(typeof r!="number")throw new W.ERR_INVALID_ARG_TYPE(e,"number",r)}function V(r,e,t){throw Math.floor(r)!==r?(j(r,t),new W.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new W.ERR_BUFFER_OUT_OF_BOUNDS:new W.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var an=/[^+/0-9A-Za-z-_]/g;function ln(r){if(r=r.split("=")[0],r=r.trim().replace(an,""),r.length<2)return"";for(;r.length%4!=0;)r=r+"=";return r}function Ce(r,e){e=e||Infinity;let t,n=r.length,i=null,o=[];for(let s=0;s<n;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&o.push(239,191,189),i=t;continue}t=(i-55296<<10|t-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;o.push(t)}else if(t<2048){if((e-=2)<0)break;o.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;o.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;o.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return o}function rn(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function sn(r,e){let t,n,i,o=[];for(let s=0;s<r.length&&!((e-=2)<0);++s)t=r.charCodeAt(s),n=t>>8,i=t%256,o.push(i),o.push(n);return o}function Et(r){return xe.toByteArray(ln(r))}function te(r,e,t,n){let i;for(i=0;i<n&&!(i+t>=e.length||i>=r.length);++i)e[i+t]=r[i];return i}function A(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function Fe(r){return r!==r}var cn=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let n=t*16;for(let i=0;i<16;++i)e[n+i]=r[t]+r[i]}return e}();function U(r){return typeof BigInt=="undefined"?pn:r}function pn(){throw new Error("BigInt not supported")}});var re=E((Kn,Tt)=>{"use strict";var{Buffer:C}=Rt(),Ut=Symbol.for("BufferList");function g(r){if(!(this instanceof g))return new g(r);g._init.call(this,r)}g._init=function(e){Object.defineProperty(this,Ut,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};g.prototype._new=function(e){return new g(e)};g.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let n=0;n<this._bufs.length;n++){let i=t+this._bufs[n].length;if(e<i||n===this._bufs.length-1)return[n,e-t];t=i}};g.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let n=0;n<e;n++)t+=this._bufs[n].length;return t};g.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};g.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};g.prototype.copy=function(e,t,n,i){if((typeof n!="number"||n<0)&&(n=0),(typeof i!="number"||i>this.length)&&(i=this.length),n>=this.length||i<=0)return e||C.alloc(0);let o=!!e,s=this._offset(n),a=i-n,h=a,l=o&&t||0,f=s[1];if(n===0&&i===this.length){if(!o)return this._bufs.length===1?this._bufs[0]:C.concat(this._bufs,this.length);for(let c=0;c<this._bufs.length;c++)this._bufs[c].copy(e,l),l+=this._bufs[c].length;return e}if(h<=this._bufs[s[0]].length-f)return o?this._bufs[s[0]].copy(e,t,f,f+h):this._bufs[s[0]].slice(f,f+h);o||(e=C.allocUnsafe(a));for(let c=s[0];c<this._bufs.length;c++){let p=this._bufs[c].length-f;if(h>p)this._bufs[c].copy(e,l,f),l+=p;else{this._bufs[c].copy(e,l,f,f+h),l+=p;break}h-=p,f&&(f=0)}return e.length>l?e.slice(0,l):e};g.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let n=this._offset(e),i=this._offset(t),o=this._bufs.slice(n[0],i[0]+1);return i[1]===0?o.pop():o[o.length-1]=o[o.length-1].slice(0,i[1]),n[1]!==0&&(o[0]=o[0].slice(n[1])),this._new(o)};g.prototype.toString=function(e,t,n){return this.slice(t,n).toString(e)};g.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};g.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};g.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(C.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(C.from(e));return this};g.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};g.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=C.from([r]):typeof r=="string"?r=C.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=C.from(r.buffer,r.byteOffset,r.byteLength):C.isBuffer(r)||(r=C.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let n=this._offset(e),i=n[0],o=n[1];for(;i<this._bufs.length;i++){let s=this._bufs[i];for(;o<s.length;)if(s.length-o>=r.length){let h=s.indexOf(r,o);if(h!==-1)return this._reverseOffset([i,h]);o=s.length-r.length+1}else{let h=this._reverseOffset([i,o]);if(this._match(h,r))return h;o++}o=0}return-1};g.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?g.prototype[t]=function(n,i){return this.slice(n,n+i)[t](0,i)}:g.prototype[t]=function(n=0){return this.slice(n,n+r[t])[t](0)}})(e)})();g.prototype._isBufferList=function(e){return e instanceof g||g.isBufferList(e)};g.isBufferList=function(e){return e!=null&&e[Ut]};Tt.exports=g});var kt=E((Qn,Mt)=>{"use strict";var ne=we(),Lt=re(),Ae=10*1024,Ot=class{constructor(){this._pool=new Uint8Array(Ae),this._poolOffset=0}write(e){let t=this._pool,n=this._poolOffset;ne.encode(e.id<<3|e.type,t,n),n+=ne.encode.bytes,ne.encode(e.data?e.data.length:0,t,n),n+=ne.encode.bytes;let i=t.subarray(this._poolOffset,n);return Ae-n<100?(this._pool=new Uint8Array(Ae),this._poolOffset=0):this._poolOffset=n,e.data?[i,e.data]:i}},Nt=new Ot;Mt.exports=r=>async function*(){for await(let t of r)Array.isArray(t)?yield new Lt(t.map(n=>Nt.write(n))):yield new Lt(Nt.write(t))}()});var qt=E((ei,Pt)=>{"use strict";var ie=we(),dn=re();Pt.exports=r=>async function*(){let t=new Dt;for await(let n of r){let i=t.write(n);i.length&&(yield i)}}();var Dt=class{constructor(){this._buffer=new dn,this._bufferProxy=new Proxy({},{get:(e,t)=>t[0]==="l"?this._buffer[t]:this._buffer.get(parseInt(t))}),this._headerInfo=null}write(e){if(!e||!e.length)return[];this._buffer.append(e);let t=[];for(;;){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch(h){break}let{id:n,type:i,length:o,offset:s}=this._headerInfo;if(this._buffer.length-s<o)break;t.push({id:n,type:i,data:this._buffer.shallowSlice(s,s+o)}),this._buffer.consume(s+o),this._headerInfo=null}return t}_decodeHeader(e){let t=ie.decode(e),n=ie.decode.bytes,i=ie.decode(e,n);return n+=ie.decode.bytes,{id:t>>3,type:t&7,offset:n,length:i}}}});var $t=E(Se=>{"use strict";Se.encode=kt();Se.decode=qt()});var Te=E((ri,Re)=>{"use strict";var Gt=1<<20;Re.exports=r=>{r=r||Gt;let e=t=>{if(t.data&&t.data.length>r)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return t=>async function*(){for await(let i of t)Array.isArray(i)?i.forEach(e):e(i),yield i}()};Re.exports.MAX_MSG_SIZE=Gt});var Ue=E(X=>{"use strict";var R=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});X.MessageTypes=R;X.InitiatorMessageTypes=Object.freeze({NEW_STREAM:R.NEW_STREAM,MESSAGE:R.MESSAGE_INITIATOR,CLOSE:R.CLOSE_INITIATOR,RESET:R.RESET_INITIATOR});X.ReceiverMessageTypes=Object.freeze({MESSAGE:R.MESSAGE_RECEIVER,CLOSE:R.CLOSE_RECEIVER,RESET:R.RESET_RECEIVER});X.MessageTypeNames=Object.freeze(Object.entries(R).reduce((r,e)=>(r[e[1]]=e[0],r),{}))});var jt=E((ii,oe)=>{"use strict";var{AbortController:zt,AbortSignal:yn}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;oe.exports=zt;oe.exports.AbortSignal=yn;oe.exports.default=zt});var Xt=E((oi,Wt)=>{"use strict";function Vt(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function wn(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Vt(r,t)}catch(n){t.message=r.message,t.stack=r.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(r)),Vt(new i,t)}}Wt.exports=wn});var Zt=E((si,vt)=>{"use strict";var En=pe(),Ht=jt(),v=he()("libp2p:mplex:stream"),gn=ce(),Yt=re(),xn=Xt(),{MAX_MSG_SIZE:mn}=Te(),{InitiatorMessageTypes:bn,ReceiverMessageTypes:Bn}=Ue(),Me="ERR_MPLEX_STREAM_RESET",In="ERR_MPLEX_STREAM_ABORT";vt.exports=({id:r,name:e,send:t,onEnd:n=()=>{},type:i="initiator",maxMsgSize:o=mn})=>{let s=new Ht,a=new Ht,h=i==="initiator"?bn:Bn,l=i==="initiator"?`i${r}`:`r${r}`;e=String(e??r);let f=!1,c=!1,p,x=d=>{f||(f=!0,v("%s stream %s source end",i,e,d),d&&!p&&(p=d),c&&(w.timeline.close=Date.now(),n(p)))},y=d=>{c||(c=!0,v("%s stream %s sink end",i,e,d),d&&!p&&(p=d),f&&(w.timeline.close=Date.now(),n(p)))},w={close:()=>w.source.end(),abort:d=>{v("%s stream %s abort",i,e,d),w.source.end(d),s.abort(),y(d)},reset:()=>{let d=xn(new Error("stream reset"),Me);a.abort(),w.source.end(d),y(d)},sink:async d=>{d=En(d,[{signal:s.signal,options:{abortMessage:"stream aborted",abortCode:In}},{signal:a.signal,options:{abortMessage:"stream reset",abortCode:Me}}]),i==="initiator"&&t({id:r,type:h.NEW_STREAM,data:e});try{for await(let m of d)for(;m.length;){if(m.length<=o){t({id:r,type:h.MESSAGE,data:m});break}m=Yt.isBufferList(m)?m:new Yt(m),t({id:r,type:h.MESSAGE,data:m.shallowSlice(0,o)}),m.consume(o)}}catch(m){return m.code===Me?v("%s stream %s reset",i,e):(v("%s stream %s error",i,e,m),t({id:r,type:h.RESET})),w.source.end(m),y(m)}t({id:r,type:h.CLOSE}),y()},source:gn(x),timeline:{open:Date.now(),close:null},id:l};return w}});var er=E((ui,Jt)=>{"use strict";var Fn=Pe(),Cn=ce(),T=he()("libp2p:mplex"),_n=pe(),Kt=$t(),An=Te(),{MessageTypes:N,MessageTypeNames:Qt}=Ue(),Sn=Zt(),Le=class{constructor(e){e=e||{},e=typeof e=="function"?{onStream:e}:e,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=e,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=e.onStream,this.onStreamEnd=e.onStreamEnd}get streams(){let e=[];return this._streams.initiators.forEach(t=>{e.push(t)}),this._streams.receivers.forEach(t=>{e.push(t)}),e}newStream(e){let t=this._streamId++;e=e==null?t.toString():String(e);let n=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:n})}_newReceiverStream({id:e,name:t}){let n=this._streams.receivers;return this._newStream({id:e,name:t,type:"receiver",registry:n})}_newStream({id:e,name:t,type:n,registry:i}){if(i.has(e))throw new Error(`${n} stream ${e} already exists!`);T("new %s stream %s %s",n,e,t);let a=Sn({id:e,name:t,send:h=>(T.enabled&&T("%s stream %s %s send",n,e,t,{...h,type:Qt[h.type],data:h.data&&h.data.slice()}),this.source.push(h)),type:n,onEnd:()=>{T("%s stream %s %s ended",n,e,t),i.delete(e),this.onStreamEnd&&this.onStreamEnd(a)},maxMsgSize:this._options.maxMsgSize});return i.set(e,a),a}_createSink(){return async e=>{this._options.signal&&(e=_n(e,this._options.signal));try{await Fn(e,Kt.decode,An(this._options.maxMsgSize),async t=>{for await(let n of t)for(let i of n)this._handleIncoming(i)})}catch(t){return T("error in sink",t),this.source.end(t)}this.source.end()}}_createSource(){let t=Cn({onEnd:n=>{let{initiators:i,receivers:o}=this._streams;for(let s of i.values())s.abort(n);for(let s of o.values())s.abort(n)},writev:!0});return Object.assign(Kt.encode(t),{push:t.push,end:t.end,return:t.return})}_handleIncoming({id:e,type:t,data:n}){if(T.enabled&&T("incoming message",{id:e,type:Qt[t],data:n.slice()}),t===N.NEW_STREAM&&this.onStream){let s=this._newReceiverStream({id:e,name:n.toString()});return this.onStream(s)}let o=(t&1?this._streams.initiators:this._streams.receivers).get(e);if(!o)return T("missing stream %s",e);switch(t){case N.MESSAGE_INITIATOR:case N.MESSAGE_RECEIVER:o.source.push(n);break;case N.CLOSE_INITIATOR:case N.CLOSE_RECEIVER:o.close();break;case N.RESET_INITIATOR:case N.RESET_RECEIVER:o.reset();break;default:T("unknown message type %s",t)}}};Le.multicodec="/mplex/6.7.0";Jt.exports=Le});var Rn=E((fi,tr)=>{"use strict";tr.exports=er()});return Rn();})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
return Libp2pMplex}));
